# templates/docker-compose-portainer.yml.j2
services:
  portainer-edge-agent:
    image: portainer/agent:2.27.3
    container_name: portainer_edge_agent
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - /var/lib/docker/volumes:/var/lib/docker/volumes
      - /:/host
      - ./data:/data
    restart: always
    environment:
      - EDGE=1
      - EDGE_ID={{ edge_id }}
      - EDGE_KEY={{ edge_key }}
      - EDGE_INSECURE_POLL=1